///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
nodebug [
    defvar  EDT_Width  1 76 -1 // in units of (fontscale Width )
    defvar  EDT_Height 1 19 -1 // in units of (fontscale Height)

    defvar  EDT_SunLightR     0 0 255
    defvar  EDT_SunLightG     0 0 255
    defvar  EDT_SunLightB     0 0 255
    defvar  EDT_SkyLightR     0 0 255
    defvar  EDT_SkyLightG     0 0 255
    defvar  EDT_SkyLightB     0 0 255
    defvar  EDT_AmbientR      0 0 255
    defvar  EDT_AmbientG      0 0 255
    defvar  EDT_AmbientB      0 0 255

    defvar  EDT_SkyboxColorR  0 0 255
    defvar  EDT_SkyboxColorG  0 0 255
    defvar  EDT_SkyboxColorB  0 0 255

    defvar  EDT_CloudColorR   0 0 255
    defvar  EDT_CloudColorG   0 0 255
    defvar  EDT_CloudColorB   0 0 255

    defvar  EDT_FogColorR     0 0 255
    defvar  EDT_FogColorG     0 0 255
    defvar  EDT_FogColorB     0 0 255
    defvar  EDT_FogDomeColorR 0 0 255
    defvar  EDT_FogDomeColorG 0 0 255
    defvar  EDT_FogDomeColorB 0 0 255

    defvar  EDT_NewMap_Size  10 10 16
    defsvar EDT_SaveMap_Name "untitled"
]

newgui "editing" [
    guikeeptab 1
    guinoautotab [
        // Save the frames 'guitabnum' hack:             H                                 V
                               if (= $guitabnum  1) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Editing      ]] ]
        guitab "ents"        ; if (= $guitabnum  2) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Entities     ]] ]
        guitab "lighting"    ; if (= $guitabnum  3) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Lighting     ]] ]
        guitab "sky"         ; if (= $guitabnum  4) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Sky          ]] ]
        guitab "skybox"      ; if (= $guitabnum  5) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Skybox       ]] ]
        guitab "cloudlayer"  ; if (= $guitabnum  6) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Cloudlayer   ]] ]
        guitab "fog"         ; if (= $guitabnum  7) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Fog          ]] ]
        guitab "height/blend"; if (= $guitabnum  8) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Height_Blend ]] ]
        guitab "map"         ; if (= $guitabnum  9) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Map          ]] ]
        guitab "cfg"         ; if (= $guitabnum 10) [ guilist [guistrut $EDT_Height 1; guilist [guistrut $EDT_Width 1; EDT_TAB_Cfg          ]] ]
    ]
] "editing"


//#############################################################################################################################################
//#############################################################################################################################################
EDT_TAB_Editing = [
    guibutton "toggle edit mode^t^t^f2[E]"  [edittoggle]
    guibar //-------------------------------------------------------------------------
    guilist [
        guilist [
            guistrut 38 1
            guitext "select^t^t^t^t^f2[MouseLeft ^f6drag^f2]"
            guitext "extend selection^t^t^f2[MouseRight]"
            guitext "move selection^t^t^t^f2[MouseRight ^f6drag^f2]"
            guitext "deselect^t^t^t^t^f2[SPACE]"
            guitext "select all ents in box^t^f2[NumPad-ENTER]"
        ]
        guilist [
            guitext "select corners^t^t^t^f2[MouseMiddle ^f6drag^f2]"
            guitext "reorient^t^t^t^t^f2[MouseRight]"
            guitext "passthrough^t^t^t^f2[LCTRL ^f6hold^f2]"
            guitext "center view on ent^t^t^f2[, + MouseWheel]"
            guitext "select all matching ents^t^f2[N]"
        ]
    ]
    guibar //-------------------------------------------------------------------------
    guilist [
        guilist [
            guistrut 38 1
            guitext "push/pull selection^t^t^f2[MouseWheel]"
            guitext "change gridsize^t^t^f2[G + MouseWheel]"
            guitext "mirror on selected axis^t^f2[X]"
        ]
        guilist [
            guitext "push cube face^t^t^f2[F + MouseWheel]"
            guitext "push corner with cursor^t^f2[Q + MouseWheel]"
            guitext "rotate^t^t^t^t^f2[R + MouseWheel]"
        ]
    ]
    guibar //-------------------------------------------------------------------------
    guilist [
        guilist [
            guistrut 38 1
            guitext "undo^t^t^t^t^t^f2[U] [Z]"
            guitext "copy^t^t^t^t^t^f2[C]"
            guitext "delete^t^t^t^t^f2[DEL]"
        ]
        guilist [
            guitext "redo^t^t^t^t^t^f2[I]"
            guitext "paste^t^t^t^t^f2[V]"
        ]
    ]
    guibar //-------------------------------------------------------------------------
    guilist [
        guilist [
            guistrut 38 1
            guitext     "change textures^t^t^f2[Y + MouseWheel]"
            guicheckbox "texture all faces^t^t^f2[0]"   allfaces
            guicheckbox "toggle outline^t^t^t^f2[7]"    outline
        ]
        guilist [
            guibutton   "texture browser..^t^t^f2[F2]"  [showtexgui]              "menu"
            guibutton   "materials.."                   [showgui "materials"]
            guicheckbox "toggle wireframe^t^t^f2[8]"    [wireframe]
        ]
    ]
]


//#############################################################################################################################################
EDT_TAB_Entities = [
    guilist [
        guilist [
            guistrut 38 1
            guibutton   "edit selected ent..^t^f2[F3]"              showentgui
            guicheckbox "entity snap-to-grid^t^f2[6]"               entselsnap
            guicheckbox "new entities take yaw from camera"         entcamdir
        ]
        guilist [
            guibutton   "edit selected entity in console^t^f2[.]"    selentedit
            guicheckbox "entity selection^t^t^f2[9]"                 myentediting //entediting
        ]
    ]
    guibar //-------------------------------------------------------------------------
    guilist [
        guilist [
            guistrut 12 1
            guitext "^f2/entdrop *"
        ]
        guilist [
            guistrut 26 1
            guiradio "(2) at selection"                       entdrop 2
            guiradio "(3) at selection, to the floor"         entdrop 3
        ]
        guilist [
            guiradio "(0) at current position"                entdrop 0
            guiradio "(1) at current position, to the floor"  entdrop 1
        ]
    ]
    guibar //-------------------------------------------------------------------------
    guilist [
        guilist [
            guistrut 12 1
            guitext "^f2/newent *"
        ]
        guilist [
            guistrut 22 1
            guibutton "light.."             [showgui "newlight"]
            guibutton "mapmodel..  ^f2[F4]" [showgui "mapmodels"]
            guibutton "teleport.."          [showgui "newteleport"]
        ]
        guilist [
            guistrut 22 1
            guibutton "playerstart"         [newent playerstart]
            guibutton "playerstart 1"       [newent playerstart 1]
            guibutton "playerstart 2"       [newent playerstart 2]
         ]
        guilist [
            guibutton "base"                [newent base]
            guibutton "flag 1"              [newent flag 1]
            guibutton "flag 2"              [newent flag 2]
        ]
    ]
    guistrut 1
    guilist [
        guilist [
            guistrut 12 1
            guialign 1 [guitext "pickups: " 0]
        ]
        guilist [
            guistrut 22 1
            guibutton "shells"        [newent shells]
            guibutton "bullets"       [newent bullets]
            guibutton "rockets"       [newent rockets]
            guibutton "riflerounds"   [newent riflerounds]
            guibutton "grenades"      [newent grenades]
            guibutton "cartridges"    [newent cartridges]
        ]
        guilist [
            guibutton "health"        [newent health]
            guibutton "healthboost"   [newent healthboost]
            guibutton "greenarmour"   [newent greenarmour]
            guibutton "yellowarmour"  [newent yellowarmour]
            guibutton "quaddamage"    [newent quaddamage]
            guibutton "select all pickup ents  ^f2/entfindpickups"   [entfindpickups]
        ]
    ]
    guistrut 1
    guilist [
        guilist [
            guistrut 12 1
            guialign 1 [guitext "SP mode: " 0]
        ]
        guilist [
            guistrut 22 1
            guibutton "monster.."  [showgui "monsters"]
        ]
        guilist [
            guistrut 22 1
            guibutton "trigger.."  [showgui "triggers"]
        ]
    ]
]


//#############################################################################################################################################
EDT_TAB_Lighting = [
    guibutton "lighting..^t^f2/adjust_lighting"  [showgui "adjust_lighting"]
    guibar //-------------------------------------------------------------------------
    EDT_LightingStuff
]


newgui "adjust_lighting" [
    //=========================================================================================================================
    guinoautotab [
        guibutton "Get sun pitch & yaw from camera.  ^f2/getsundir" [getsundir]
        guitext "sunlightpitch: "; guislider sunlightpitch
        guitext "sunlightyaw: "  ; guislider sunlightyaw
        guibar //-------------------------------------------------------------------------
        EDT_SunLightR (& (>> $sunlight 16) 0xFF)
        EDT_SunLightG (& (>> $sunlight  8) 0xFF)
        EDT_SunLightB (&     $sunlight     0xFF)
        guilist [guitext "sunlightscale: "; guifield sunlightscale 8]
        guilist [guitext "sunlight:^t^t^t^t^t^t^t^t"; guicolor $sunlight]
        guislider EDT_SunLightR 0 255 [sunlight $EDT_SunLightR $EDT_SunLightG $EDT_SunLightB]
        guislider EDT_SunLightG 0 255 [sunlight $EDT_SunLightR $EDT_SunLightG $EDT_SunLightB]
        guislider EDT_SunLightB 0 255 [sunlight $EDT_SunLightR $EDT_SunLightG $EDT_SunLightB]
        guibar //-------------------------------------------------------------------------
        EDT_SkyLightR (& (>> $skylight 16) 0xFF)
        EDT_SkyLightG (& (>> $skylight  8) 0xFF)
        EDT_SkyLightB (&     $skylight     0xFF)
        guilist [guitext "skylight:^t^t^t^t^t^t^t^t"; guicolor $skylight]
        guislider EDT_SkyLightR 0 255 [skylight $EDT_SkyLightR $EDT_SkyLightG $EDT_SkyLightB]
        guislider EDT_SkyLightG 0 255 [skylight $EDT_SkyLightR $EDT_SkyLightG $EDT_SkyLightB]
        guislider EDT_SkyLightB 0 255 [skylight $EDT_SkyLightR $EDT_SkyLightG $EDT_SkyLightB]
        guibar //-------------------------------------------------------------------------
        EDT_AmbientR (& (>> $ambient  16) 0xFF)
        EDT_AmbientG (& (>> $ambient   8) 0xFF)
        EDT_AmbientB (&     $ambient      0xFF)
        guilist [guitext "ambient:^t^t^t^t^t^t^t^t"; guicolor $ambient]
        guislider EDT_AmbientR 0 255 [ambient $EDT_AmbientR $EDT_AmbientG $EDT_AmbientB]
        guislider EDT_AmbientG 0 255 [ambient $EDT_AmbientR $EDT_AmbientG $EDT_AmbientB]
        guislider EDT_AmbientB 0 255 [ambient $EDT_AmbientR $EDT_AmbientG $EDT_AmbientB]
    //=========================================================================================================================
    guitab "settings"
        EDT_LightingStuff
    ]
] "sunlight"

TODO 0 "menus.cfg -- Additional LightingStuff?"
//  fullbrightlevel

//  clearlightmaps
//  edgetolerance
//  adaptivesample

//  roundlightmaptex ???
//  dumplms

//  lerpangle
//  lerpsubdiv
//  lerpsubdivsize
//  lerptjoints

//  lmaa
//  lmshadows  0: none  1: Geo only  2: Geo + Mapmodels

//  maxmerge

//  CalcLight -1: lmshadows = 1  ; lmaa = 0  ; lerptjoints = 0
//  CalcLight  0: lmshadows = VAR; lmaa = VAR; lerptjoints = VAR
//  CalcLight  1: lmshadows = 2  ; lmaa = 3  ; lerptjoints = 1

EDT_LightingStuff = [
    guicheckbox "fullbright^t^t^f2[L]" [fullbright]
    guibar //-------------------------------------------------------------------------
    guilist [
        guitext "blurskylight:^t"
        guiradio "0 " blurskylight 0
        guiradio "1 " blurskylight 1
        guiradio "2 " blurskylight 2
    ]
    guilist [
        guitext "blurlightmaps:^t"
        guiradio "0 " blurlms 0
        guiradio "1 " blurlms 1
        guiradio "2 " blurlms 2
    ]
    guistrut 1
    guitext "lightprecision:"
    guilistslider lightprecision [8 16 32 48 64 96 128 256]
    guitext "lightlod: (>= use lightprecision, < use lightprecision/2)"
    guislider lightlod
    guistrut 1
    guitext "lighterror:"
    guislider lighterror
    guibar //-------------------------------------------------------------------------
    guibutton "calclight^t1^t^f~(slow: 8xAA)"                       [calclight  1]
    guibutton "calclight^t-1^t^f~(quick: no AA, no model shadows)"  [calclight -1]
    guitext "lightthreads:"
    guislider lightthreads
]


//#############################################################################################################################################
EDT_TAB_Sky = [
    guistayopen [
        EDT_SkyboxColorR (& (>> $skyboxcolour 16) 0xFF)
        EDT_SkyboxColorG (& (>> $skyboxcolour  8) 0xFF)
        EDT_SkyboxColorB (&     $skyboxcolour     0xFF)
        guilist [
            guilist [
                guistrut 18 1
                guialign 1 [guitext "skyboxcolour: " 0]
                guistrut 1
                guialign 1 [guicolor $skyboxcolour; guistrut 1]
            ]
            guilist [
                guistrut 57 1
                guislider EDT_SkyboxColorR 0 255 [skyboxcolour $EDT_SkyboxColorR $EDT_SkyboxColorG $EDT_SkyboxColorB]
                guislider EDT_SkyboxColorG 0 255 [skyboxcolour $EDT_SkyboxColorR $EDT_SkyboxColorG $EDT_SkyboxColorB]
                guislider EDT_SkyboxColorB 0 255 [skyboxcolour $EDT_SkyboxColorR $EDT_SkyboxColorG $EDT_SkyboxColorB]
            ]
        ]
        guistrut 1 //-------------------------------------------------------------------------
        guifreerow 18  1 [ guitext "rotation: " 0
                 ] 12 -2 [ guitext "yawsky:"
                 ] 45 -2 [ guislider yawsky
        ]
        guistrut 1 //-------------------------------------------------------------------------
        guifreerow 18  1 [ guitext "animation: " 0
                 ]  1 -2 [ guifield2 "spinsky:" 12 spinsky 6 -0.1 0.1
        ]
    ]


    //@@    Do atmo stuff...


]
TODO 0 "menus.cfg -- editing/sky: Atmo, CloudBox?"


//#############################################################################################################################################
EDT_TAB_Skybox = [
    guilist [
        guistayopen [
            guilist [_genskyitems $_skies1]
            guilist [_genskyitems $_skies2]
            guilist [_genskyitems $_skies3]
            _skyboxpreview
        ]
    ]
]
_genskyitems = [
    looplist iSky $arg1 [
        guibutton $iSky (concat skybox $iSky) "cube"
    ]
]
_skyboxpreview = [
    guibar
    _skyshotname = (checkrolloveraction "skybox " [if (> $numargs 0) [result $arg1] [at $guirollovername 0]])
    guiimage (concatword "<thumbnail:128>packages/" $_skyshotname "_ft") (checkrolloveraction "skybox ") 4 1 "data/cube.png" (chopstr $_skyshotname -16 "..")
]


TODO 0 "menus.cfg -- Make skybox a list type menu, sepearate from editing menus.  Generalize 'guimaplist'?"

_skies1 = [
    skyboxes/black
    skyboxes/white
    aftas/sky/orbe
    blindabuser/blindasky
    blindabuser/blindasky2
    darc/forge
    dash/moon
    hazel/green
    humus/meadow
    ik2k/env/iklake
    jon/prarie
    mayhem/duomo
    mayhem/eclipse
    meister/uzze
    penguins/arid
    penguins/arid2
    penguins/cocoa
    penguins/divine
    penguins/harmony
]
_skies2 = [
    penguins/mellow
    penguins/mystic
    penguins/violence
    penguins/wrath
    penguins/yonder
    penguins/zeus
    ratboy/skyboxes/coward
    shmutzwurst/london
    skyboxes/bbk/d
    skyboxes/bbk/dark2
    skyboxes/bbk/n1
    skyboxes/bbk/t
    skyboxes/clearsky052
    skyboxes/darkness
    skyboxes/evilsky
    skyboxes/morning
    skyboxes/remus/sky01
    skyboxes/turbulent
    skyboxes/ulukai/corona
]
_skies3 = [
    socksky/barren
    socksky/desert
    socksky/devpun
    socksky/emerald
    socksky/frozen
    socksky/frozendusk
    socksky/grave
    socksky/mars
    socksky/nightball
    socksky/stratosphere
    socksky/valley
    staffy/staffy
]


//#############################################################################################################################################
EDT_TAB_Cloudlayer = [
    guistayopen [
        guilist [
            guilist [
                guistrut 18 1
                guialign 1 [guitext "cloudlayer: " 0]
            ]
            guilist [
                guistrut 28 1
                guibutton "skyboxes/clouds01.png"  [cloudlayer "skyboxes/clouds01.png"]
                guibutton "skyboxes/clouds02.png"  [cloudlayer "skyboxes/clouds02.png"]
                guibutton "skyboxes/clouds03.png"  [cloudlayer "skyboxes/clouds03.png"]
                guibutton "skyboxes/white_bk.jpg"  [cloudlayer "skyboxes/white_bk.jpg"]
                guibutton "^f8*no clouds*"         [cloudlayer ""]
            ]
            guilist [
                guibutton "blindabuser/blindaclouds.png"  [cloudlayer "blindabuser/blindaclouds.png"]
                guibutton "skyboxes/cloud_ring.png"       [cloudlayer "skyboxes/cloud_ring.png"]
                guibutton "textures/razgriz/cloud03.png"  [cloudlayer "textures/razgriz/cloud03.png"]
                guibutton "textures/razgriz/cloud04.png"  [cloudlayer "textures/razgriz/cloud04.png"]
            ]
        ]
        guistrut 1 //-------------------------------------------------------------------------
        EDT_CloudColorR (& (>> $cloudcolour 16) 0xFF)
        EDT_CloudColorG (& (>> $cloudcolour  8) 0xFF)
        EDT_CloudColorB (&     $cloudcolour     0xFF)
        guilist [
            guilist [
                guistrut 18 1
                guialign 1 [guitext "cloudcolour: " 0]
                guistrut 1
                guialign 1 [guicolor $cloudcolour; guistrut 1]
            ]
            guilist [
                guistrut 57 1
                guislider EDT_CloudColorR 0 255 [cloudcolour $EDT_CloudColorR $EDT_CloudColorG $EDT_CloudColorB]
                guislider EDT_CloudColorG 0 255 [cloudcolour $EDT_CloudColorR $EDT_CloudColorG $EDT_CloudColorB]
                guislider EDT_CloudColorB 0 255 [cloudcolour $EDT_CloudColorR $EDT_CloudColorG $EDT_CloudColorB]
            ]
        ]
        guistrut 1 //-------------------------------------------------------------------------
        guifreerow 18  1 [ guitext "transparency: " 0
                 ] 28 -2 [ guifield2 "cloudalpha:"     15.5  cloudalpha     6  -0.05 0.05
                 ] 28 -2 [ guifield2 "cloudfade:"      15.5  cloudfade      6  -0.05 0.05
        ]
        guistrut 1 //-------------------------------------------------------------------------
        guifreerow 18  1 [ guitext "position/scale: " 0
                 ] 28 -2 [ guifield2 "cloudoffsetx:"   15.5  cloudoffsetx   6  -0.01 0.01
                 ] 28 -2 [ guifield2 "cloudheight:"    15.5  cloudheight    6  -0.01 0.01
        ]
        guifreerow 18 -2 [
                 ] 28 -2 [ guifield2 "cloudoffsety:"   15.5  cloudoffsety   6  -0.01   0.01
                 ] 28 -2 [ guifield2 "cloudscale:"     15.5  cloudscale     6  -0.0625 0.0625
        ]
        guistrut 1 //-------------------------------------------------------------------------
        guifreerow 18  1 [ guitext "animation: " 0
                 ] 28 -2 [ guifield2 "cloudscrollx:"   15.5  cloudscrollx   6  -0.0005 0.0005
                 ] 28 -2 [ guifield2 "spincloudlayer:" 15.5  spincloudlayer 6  -0.1    0.1
        ]
        guifreerow 18 -2 [
                 ] 28 -2 [ guifield2 "cloudscrolly:"   15.5  cloudscrolly   6  -0.0005 0.0005
        ]
    ]
]


//#############################################################################################################################################
EDT_TAB_Fog = [
    guistayopen [
        guifreerow 18  1 [ guitext "fog: " 0
                 ] 57 -2 [ guislider fog 128 16384
        ]
        guistrut 1
        EDT_FogColorR (& (>> $fogcolour 16) 0xFF)
        EDT_FogColorG (& (>> $fogcolour  8) 0xFF)
        EDT_FogColorB (&     $fogcolour     0xFF)
        guilist [// H
            guilist [// V
                guistrut 18 1
                guialign 1 [guitext "fogcolour: " 0]
                guistrut 1
                guialign 1 [guicolor $fogcolour; guistrut 1]
            ]
            guilist [// V
                guistrut 57 1
                guislider EDT_FogColorR 0 255 [fogcolour $EDT_FogColorR $EDT_FogColorG $EDT_FogColorB]
                guislider EDT_FogColorG 0 255 [fogcolour $EDT_FogColorR $EDT_FogColorG $EDT_FogColorB]
                guislider EDT_FogColorB 0 255 [fogcolour $EDT_FogColorR $EDT_FogColorG $EDT_FogColorB]
            ]
        ]
        guibar //-------------------------------------------------------------------------
        EDT_FogDomeColorR (& (>> $fogdomecolour 16) 0xFF)
        EDT_FogDomeColorG (& (>> $fogdomecolour  8) 0xFF)
        EDT_FogDomeColorB (&     $fogdomecolour     0xFF)
        guilist [// H
            guilist [// V
                guistrut 18 1
                guialign 1 [guitext "fogdomecolour: " 0]
                guialign 1 [guitext "^f4(0 = use fogcolour) " 0]
                guialign 1 [guicolor $fogdomecolour; guistrut 1]
            ]
            guilist [// V
                guistrut 57 1
                guislider EDT_FogDomeColorR 0 255 [fogdomecolour $EDT_FogDomeColorR $EDT_FogDomeColorG $EDT_FogDomeColorB]
                guislider EDT_FogDomeColorG 0 255 [fogdomecolour $EDT_FogDomeColorR $EDT_FogDomeColorG $EDT_FogDomeColorB]
                guislider EDT_FogDomeColorB 0 255 [fogdomecolour $EDT_FogDomeColorR $EDT_FogDomeColorG $EDT_FogDomeColorB]
            ]
        ]
        guistrut 1 //-------------------------------------------------------------------------
        guilist [// H
            guilist [// V
                guistrut 18 1
            ]
            guilist [// V
                guistrut 28 1
                guifield2 "fogdomeclip:"   15.5  fogdomeclip   6  -0.01 0.01
                guifield2 "fogdomemin:"    15.5  fogdomemin    6  -0.01 0.01
                guifield2 "fogdomemax:"    15.5  fogdomemax    6  -0.01 0.01
                guifield2 "fogdomeheight:" 15.5  fogdomeheight 6  -0.01 0.01
            ]
            guilist [// V
                guicheckbox "fogdomeclouds" fogdomeclouds
                guistrut 0.5
                guicheckbox "fogdomesquare" fogdomesquare
                guistrut 0.5
                guicheckbox "fogdomecap"    fogdomecap
            ]
        ]
    ]
]


//#############################################################################################################################################
EDT_TAB_Height_Blend = [
    guilist [// H
        guilist [// V
            guistrut 38 1
            guitext "toggle heightmap mode^t^t^f2[H]"
            guitext "push/pull heightmap^t^t^t^f2[MouseWheel]"
        ]
        guitext "select heightmap brush^t^f2[B + MouseWheel]"
    ]
    guibar //-------------------------------------------------------------------------
    guitext "blend paint mode:"
    guilist [// H
        guilist [// V
            guistrut 38 1
            guiradio (concatword (at $Labels_BlendPaintMode 0) "^t^t^t^t^t^t^f2[NumPad 0]")    blendpaintmode 0
            guiradio (concatword (at $Labels_BlendPaintMode 2) "^t^t^t^t^t^t^f2[NumPad 1]")    blendpaintmode 2
            guiradio (concatword (at $Labels_BlendPaintMode 4)                            )    blendpaintmode 4
        ]
        guilist [// V
            guiradio (concatword (at $Labels_BlendPaintMode 1)                            )    blendpaintmode 1
            guiradio (concatword (at $Labels_BlendPaintMode 3)                            )    blendpaintmode 3
            guiradio (concatword (at $Labels_BlendPaintMode 5) "^t^t^t^t^t^f2[NumPad 2]"  )    blendpaintmode 5
        ]
    ]
    guistrut 1
    guitext "paint blendmap^t^t^t^f2[MouseLeft]"
    guitext "change blend brush^t^t^t^f2[MouseWheel]"
    guitext "rotate blend brush^t^t^t^f2[MouseRight]"
    guistrut 1
    guibutton "clear entire blendmap^t^t^f2/clearblendmap"        [clearblendmap]
    guibutton "clear blendmap in selection^t^f2/clearblendmapsel" [clearblendmapsel]
]


//#############################################################################################################################################
EDT_TAB_Map = [
    guifreerow 18  1 [ guitext "newmap: " 0
             ] 12 -2 [ guitext "scale:"
             ] 45 -2 [ guislider EDT_NewMap_Size 10 16
    ]
    guifreerow 18 -2 [
             ] 12 -2 [ guitext "size:"
             ] 45 -2 [ guinameslider EDT_NewMap_Size ["1024" "2048" "4096" "8192" "16384" "32768" "65536"] [10 11 12 13 14 15 16] []
    ]
    guifreerow 18 -2 [
             ]  1 -2 [ guibutton "create newmap" [newmap $EDT_NewMap_Size]
    ]
    guistrut 1 //-------------------------------------------------------------------------
    guifreerow 18  1 [ guitext "savemap: " 0
             ] 24 -2 [ guifield  EDT_SaveMap_Name 22
             ]  1 -2 [ guibutton "save" [savemap $EDT_SaveMap_Name]
    ]
    guibar //-------------------------------------------------------------------------
    guifreerow 18 -2 [
             ]  1 -2 [ guibutton "set map title/author"  [saycommand [/maptitle @maptitle]]
    ]
    guibar //-------------------------------------------------------------------------
    guifreerow 18 -2 [
             ] 24 -2 [ guibutton "^f2/remip"   [remip]
             ]  1 -2 [ guitext "^f4(optimize octree/geometry)" 0
    ]
    guifreerow 18 -2 [
             ] 24 -2 [ guibutton "^f2/recalc"  [recalc]
             ]  1 -2 [ guitext "^f4(regenerate: envmaps, minimap, etc)" 0
    ]
    guibar //-------------------------------------------------------------------------
    guifreerow 18  1 [ guitext "resize: " 0
             ]  1 -2 [ guibutton "increase mapsize (2x)"  mapenlarge
    ]
    guifreerow 18 -2 [
             ] 24 -2 [ guibutton "decrease mapsize (1/2)"  shrinkmap
             ]  1 -2 [ guitext "^f4(shrunk area must be empty)" 0
    ]
    guibar //-------------------------------------------------------------------------
    guifreerow 18  1 [ guitext "undo size: " 0
             ] 57 -2 [ guilistslider undomegs [1 2 3 4 6 8 12 16 20 24 32 40 48 56 64 72 80 88 96 100]
    ]
    guifreerow 18 -2 [
             ] 24 -2 [ guitext "^f4(in megabytes)" 0
             ] 33  1 [ guitext "^f4(default 8)" 0
    ]
]


//#############################################################################################################################################
EDT_TAB_Cfg = [
    guitext (mapcfgname)
    guitexteditor (mapcfgname) -73 17
]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
TODO 0 "menus.cfg -- Rework all this editing stuff."


newgui "materials" [
    guibutton "air"                        [editmat air]
    guibutton "water"                      [editmat water]
    guibutton "lava"                       [editmat lava]
    guibutton "clip"                       [editmat clip]
    guibutton "glass"                      [editmat glass]
    guibutton "noclip"                     [editmat noclip]
    guibutton "gameclip"                   [editmat gameclip]
    guibutton "death"                      [editmat death]
    guibutton "alpha"                      [editmat alpha]

    guicheckbox "show material volumes"    [showmat]

    //guibutton "waterlod very high (3)"  [waterlod 3]
    //guibutton "waterlod high      (2)"  [waterlod 2]
    //guibutton "waterlod default   (1)"  [waterlod 1]
    //guibutton "waterlod low       (0)"  [waterlod 0]

    //guibutton "watersubdiv very fine (0)"  [watersubdiv 0]
    //guibutton "watersubdiv fine      (1)"  [watersubdiv 1]
    //guibutton "watersubdiv default   (2)"  [watersubdiv 2]
    //guibutton "watersubdiv coarse    (3)"  [watersubdiv 3]

    //guibutton "water waves on"  [waterwaves 1]
    //guibutton "water waves off" [waterwaves 0]
]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
newgui "triggers" [
    guibutton "invisible"   [BTmm = -1; showgui "trigger2"]
    guibutton "a carrot"    [BTmm = 23; showgui "trigger2"]
    guibutton "switch #1"   [BTmm = 24; showgui "trigger2"]
    guibutton "switch #2"   [BTmm = 25; showgui "trigger2"]
    guibutton "door #1"     [BTmm = 26; showgui "trigger2"]
    guibutton "door #2"     [BTmm = 27; showgui "trigger2"]
    guibutton "door #3"     [BTmm = 28; showgui "trigger2"]
]

newgui "trigger2" [
    guibutton "animation loop"                      [BTtt =  0; showgui "trigger3"]
    guibutton "trigger once (popback)"              [BTtt =  1; showgui "trigger3"]
    guibutton "trigger once (popback & rumble)"     [BTtt =  2; showgui "trigger3"]
    guibutton "trigger once"                        [BTtt =  3; showgui "trigger3"]
    guibutton "trigger once (rumble)"               [BTtt =  4; showgui "trigger3"]
    guibutton "trigger multiple (popback)"          [BTtt =  5; showgui "trigger3"]
    guibutton "trigger multiple (popback & rumble)" [BTtt =  6; showgui "trigger3"]
    guibutton "trigger multiple"                    [BTtt =  7; showgui "trigger3"]
    guibutton "trigger multiple (rumble)"           [BTtt =  8; showgui "trigger3"]
    guibutton "door (open once)"                    [BTtt =  9; showgui "trigger3"]
    guibutton "door (auto close)"                   [BTtt = 10; showgui "trigger3"]
    guibutton "door (locked)"                       [BTtt = 11; showgui "trigger3"]
    guibutton "vanishing trigger"                   [BTtt = 12; showgui "trigger3"]
    guibutton "vanishing trigger (rumble)"          [BTtt = 13; showgui "trigger3"]
    guibutton "End Of Level Trigger"                [BTtt = 29; showgui "trigger3"]
]

build_trigger = [newent mapmodel $BTmm $BTtt $BTti]
newgui "trigger3" [
    loop i 9 [
        _tjt = (concat tag (concatword # $i))
        _tjc = (concat BTti "=" $i ";" "build_trigger")
        guibutton $_tjt $_tjc
    ]
]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
NL_ResetLight = [
    NL_ColorPreset =   0
    NL_Bright      =   1
    NL_Radius      = 128
    NL_LightSet 255 255 255
]

NL_LightSet = [
    NL_ColorR = $arg1
    NL_ColorG = $arg2
    NL_ColorB = $arg3
    if (= $NL_Bright 0) NL_LightScale
]

NL_LightScale = [
    if (= $NL_Bright 0) [
        NL_ColorR = (div $NL_ColorR 2); NL_ColorG = (div $NL_ColorG 2); NL_ColorB = (div $NL_ColorB 2)
    ] [
        NL_ColorR = (min 255 (* $NL_ColorR 2)); NL_ColorG = (min 255 (* $NL_ColorG 2)); NL_ColorB = (min 255 (* $NL_ColorB 2))
    ]
]

NL_CreateLight = [result (concat newent light $NL_Radius $NL_ColorR $NL_ColorG $NL_ColorB)]
newgui "newlight" [
    guialign 0 [guibutton (concatword " ^f7/newent ^f2light ^f3" (NL_ColorR) " ^f0" (NL_ColorG) " ^f1" (NL_ColorB) ) (NL_CreateLight) 0]
    guibar
    guitext "color:"
    guicolor (+ (* (+ (* $NL_ColorR 256) $NL_ColorG) 256) $NL_ColorB)
    guislider NL_ColorR 0 255
    guislider NL_ColorG 0 255
    guislider NL_ColorB 0 255
    guilist [
        guicheckbox "bright"    NL_Bright 1 0 [NL_LightScale]
        guibar
        guiradio "white"        NL_ColorPreset 0 [NL_LightSet 255 255 255]
        guiradio "red"          NL_ColorPreset 1 [NL_LightSet 255 192 192]
        guiradio "yellow"       NL_ColorPreset 2 [NL_LightSet 255 255 192]
        guiradio "green"        NL_ColorPreset 3 [NL_LightSet 192 255 192]
        guiradio "cyan"         NL_ColorPreset 4 [NL_LightSet 192 255 255]
        guiradio "blue"         NL_ColorPreset 5 [NL_LightSet 192 192 255]
        guiradio "purple"       NL_ColorPreset 6 [NL_LightSet 255 192 255]
    ]
    guitext "radius:"
    guislider NL_Radius 0 512
    guistrut 1
    guialign 0 [guibutton "^f2Create Light" (NL_CreateLight) 0]
] "" [NL_ResetLight]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
newgui "newteleport" [
    guibutton "newent teleport 1"
    guibutton "newent teledest 1"

    guibutton "newent teleport 2"
    guibutton "newent teledest 2"

    guibutton "newent teleport 3"
    guibutton "newent teledest 3"

    guibutton "newent teleport 4"
    guibutton "newent teledest 4"
]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
newgui "monsters" [
    guialign 0 [guitext " type        weapon" 0]
    guibar
    guibutton "(0) Ogro^t^t^t^f5FireBall"           [newent monster 0];
    guibutton "(1) Rhino^t^t^t^f0Chaingun"          [newent monster 1];
    guibutton "(2) Ratamahatta^t^f3Shotgun"         [newent monster 2];
    guibutton "(3) Slith^t^t^t^f1Rifle"             [newent monster 3];
    guibutton "(4) Bauul^t^t^t^f6RocketLauncher"    [newent monster 4];
    guibutton "(5) Hellpig^t^t^f2Bite"              [newent monster 5];
    guibutton "(6) Knight^t^t^t^f5IceBall"          [newent monster 6];
    guibutton "(7) Goblin^t^t^t^f5SlimeBall"        [newent monster 7];
    guibutton "(8) Spider^t^t^t^f8Grenade"          [newent monster 8];
]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
entupdate = [ entset $entguitype $entguiattr0 $entguiattr1 $entguiattr2 $entguiattr3 $entguiattr4 ]

initentgui = [
    entguitype = (enttype)
    @(loopconcat i 5 [
        result [ entguiattr@i = (entattr @i) ]
        ]
    )
]

genentattributes = [
    entattributes = (loopconcat i (listlen $arg2) [
        entattribname = (at $arg2 $i)
        entattriblimits = (at $arg3 (* 2 $i))
        entattriblimits2 = (at $arg3 (+ 1 (* 2 $i)))
        if (=s (at $entattriblimits 0) $entattriblimits) [
            result [
                guitext @entattribname
                guislider entguiattr@i @entattriblimits @entattriblimits2 entupdate
            ]
        ][
            result [
                guitext @entattribname
                guinameslider entguiattr@i [@@entattriblimits] [@@entattriblimits2] entupdate
            ]
        ]
    ])
]

quickeditmenu = [
    guitext "Quick Commands:"
    guibar
    guifield  EDT_SaveMap_Name 10 [ savemap $EDT_SaveMap_Name ]
    guibutton "quick light"       [calclight -1]
    guibutton "optimize map"      [remip]
    guibutton "new entity"        [newent shells]
    guibar
    guibutton newmap
    guibar
    guibutton help "showgui editing"
]

matmenu = [
    guibutton "air"                        [editmat air]
    guibutton "water"                      [editmat water]
    guibutton "lava"                       [editmat lava]
    guibutton "clip"                       [editmat clip]
    guibutton "glass"                      [editmat glass]
    guibutton "noclip"                     [editmat noclip]
    guibutton "gameclip"                   [editmat gameclip]
    guibutton "death"                      [editmat death]
    guibutton "alpha"                      [editmat alpha]
    guicheckbox "show material volumes"    [showmat]
]

brushmenu = [
    guititle diamonds
    guilist [
        guiimage "packages/icons/brush_1c.png"   [brush_0]
        guiimage "packages/icons/brush_21c.png"  [brush_1]
        guiimage "packages/icons/brush_421c.png" [brush_2]
    ]
    guititle squares
    guilist [
        guiimage "packages/icons/brush_3s.png"   [brush_3]
        guiimage "packages/icons/brush_5s.png"   [brush_4]
        guiimage "packages/icons/brush_7s.png"   [brush_5]
    ]
    guititle smooth
    guilist [
        guiimage "packages/icons/brush_3s.png"   [brush_6]
        guiimage "packages/icons/brush_5s.png"   [brush_7]
        guiimage "packages/icons/brush_7s.png"   [brush_8]
    ]
]

newentgui = [
    genentattributes $arg1 $arg2 $arg3
    newgui $arg1 [
        guitext $entguitype
        guibar
        @entattributes
        guitab type
        guilistsplit n 2 $EntityTypes [
            guibutton $n [ entset @n ]
        ]
        guitab misc
        @quickeditmenu
    ] "" [initentgui]
]

looplist i $EntityTypes [
    newentgui $i "" ""
]

newgui "materials" [
    @matmenu
    guitab misc
    @quickeditmenu
]

newgui "brushes" [
    @brushmenu
    guitab misc
    @quickeditmenu
]

newgui "quickedit" [
    @quickeditmenu
    guitab materials
    @matmenu
]

newentgui light "radius red green blue" "1 400 0 255 0 255 0 255"
newentgui spotlight "radius" "0 200"
newentgui playerstart "direction" "0 360"
newentgui teleport "tag" "0 20"
newentgui teledest "direction tag" "0 360 0 20"
newentgui monster "direction type" "0 360 0 7"
newentgui mapmodel "direction model" "0 360 0 372"
newentgui envmap "radius" "0 512"
newentgui jumppad "Z Y X" "-128 128 -128 127 -128 127"
newentgui sound "type radius size" "0 20 0 500 0 500"
newentgui particles "type" "0 13"

showentgui = [ contexteditgui ] // legacy bind
contexteditgui = [
    if $hmapedit [showgui "brushes"] [
        if (enthavesel) [
            showgui (enttype)
        ][
            showgui (? (havesel) materials quickedit)
        ]
    ]
]

newgui "seltexinfo" [
    guitext (concatword "Slot: " (getseltex))
    guilist [
        loop iSubSlot 5 [
            _texname = (gettexname (getseltex) $iSubSlot)
            _texname = (substr $_texname (+ (strstr $_texname ">") 1)) // chop off any leading commands
            guiimage (concatword "packages/" $_texname) "" 1 1
        ]
    ]
    loop iSubSlot 5 [
        _texname = (gettexname (getseltex) $iSubSlot)
        if (strcmp $_texname "") [] [guitext $_texname]
    ]
]



TODO 0 "menus.cfg -- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"









///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  vColor Editor:

nodebug [
    defvar  VCE_Red -1 100000  100000
    defvar  VCE_Grn -1 100000  100000
    defvar  VCE_Blu -1 100000  100000

    defvar  VCE_Hue -1      0  360000
    defvar  VCE_Sat -1      0  100000
    defvar  VCE_Vib -1 100000  100000

    defsvar VCE_RGB "1.0 1.0 1.0"
    defsvar VCE_HSV "1.0 1.0 1.0"

    defvar  VCE_WidthC 2 64 128
    defvar  VCE_WidthE 2 64 128

    defvar  VCE_LiveSet 0 0 1 [if (&& $VCE_LiveSet (ingamemp)) [VCE_LiveSet 0]]
]

VCE_Get = [ // (colorvectoivec LIST)
    VCE_Red = (*f (at (getvcolor $getseltex) 0) 100000)
    VCE_Grn = (*f (at (getvcolor $getseltex) 1) 100000)
    VCE_Blu = (*f (at (getvcolor $getseltex) 2) 100000)
    VCE_UpdateHSV
]
VCE_Set = [ // (colorivectovec LIST)
    vcolor (*f $VCE_Red 0.00001) (*f $VCE_Grn 0.00001) (*f $VCE_Blu 0.00001)
]
VCE_UpdateHSV = [
    VCE_HSV = (color_rgbtohsv (concat (*f $VCE_Red 0.00001) (*f $VCE_Grn 0.00001) (*f $VCE_Blu 0.00001)))
    VCE_Hue = (*f (at $VCE_HSV 0) 100000)
    VCE_Sat = (*f (at $VCE_HSV 1) 100000)
    VCE_Vib = (*f (at $VCE_HSV 2) 100000)
]
VCE_UpdateRGB = [
    VCE_RGB = (color_hsvtorgb (concat (*f $VCE_Hue 0.00001) (*f $VCE_Sat 0.00001) (*f $VCE_Vib 0.00001)))
    VCE_Red = (*f (at $VCE_RGB 0) 100000)
    VCE_Grn = (*f (at $VCE_RGB 1) 100000)
    VCE_Blu = (*f (at $VCE_RGB 2) 100000)
]

newgui "vcolor" [
    if (|| (! $editing) (! (ingame))) [cleargui 1] [
        guistayopen [
            guistrut 192 1
            guialign 0 [// H
                guilist [// V
                    guistrut 48 1
                ]
                guitext "^f2vcolor: " 0
                guilist [guistrut 8 1; guitext (concatword "^f3" (at (getvcolor $getseltex) 0)) 0]
                guilist [guistrut 8 1; guitext (concatword "^f0" (at (getvcolor $getseltex) 1)) 0]
                guilist [guistrut 8 1; guitext (concatword "^f1" (at (getvcolor $getseltex) 2)) 0]
                //guibar
                guibutton "^f2[GET]" [VCE_Get] 0
                guistrut 2.5
                guibutton "^f8[~~~~~~~SET~~~~~~~]" [VCE_Set] 0
                guistrut 2.5
                if (= (ingamemp) 0) [guicheckbox "LiveSet" VCE_LiveSet 1 0]
                guilist [// V
                    guistrut 48 1
                    if (&& $VCE_LiveSet (= (ingamemp) 0)) [
                        guitext "  Warning: LiveSet will spam vslot creation." 0
                    ]
                ]
            ]
            guialign 0 [// H
                guilist [// V
                    guistrut 0.5; guitext "^f8R: " 0
                    guistrut 0.5; guitext "^f8G: " 0
                    guistrut 0.5; guitext "^f8B: " 0
                ]
                guilist [// V
                    guistrut 64 1
                    guistrut 0.5; guislider VCE_Red 0 100000 [VCE_UpdateHSV; if (&& $VCE_LiveSet (= (ingamemp) 0)) [VCE_Set]]
                    guistrut 0.5; guislider VCE_Grn 0 100000 [VCE_UpdateHSV; if (&& $VCE_LiveSet (= (ingamemp) 0)) [VCE_Set]]
                    guistrut 0.5; guislider VCE_Blu 0 100000 [VCE_UpdateHSV; if (&& $VCE_LiveSet (= (ingamemp) 0)) [VCE_Set]]
                ]
                guilist [// V
                    guistrut 8 1
                    guistrut 0.5; guialign 1 [guitext "^f8H: " 0] // H
                    guistrut 0.5; guialign 1 [guitext "^f8S: " 0] // H
                    guistrut 0.5; guialign 1 [guitext "^f8V: " 0] // H
                ]
                guilist [// V
                    guistrut 64 1
                    guistrut 0.5; guislider VCE_Hue 0 360000 [VCE_UpdateRGB; if (&& $VCE_LiveSet (= (ingamemp) 0)) [VCE_Set]]
                    guistrut 0.5; guislider VCE_Sat 0 100000 [VCE_UpdateRGB; if (&& $VCE_LiveSet (= (ingamemp) 0)) [VCE_Set]]
                    guistrut 0.5; guislider VCE_Vib 0 100000 [VCE_UpdateRGB; if (&& $VCE_LiveSet (= (ingamemp) 0)) [VCE_Set]]
                ]
            ]
        ]
    ]
] 0


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  vShaderParam Editor:

nodebug [
    defvar vsha 0 0 1
]

newgui "vshaderparam" [
    guitext "TODO" 0
    guistrut 1
    guicheckbox "envscale" vsha
    guicheckbox "glowcolor" vsha
    guicheckbox "parallaxscale" vsha
    guicheckbox "pulseglowcolor" vsha
    guicheckbox "pulseglowspeed" vsha
    guicheckbox "pulsespeed" vsha
    guicheckbox "specscale" vsha
] 0 []
TODO 0 "menus.cfg -- vShaderParam Editor..."

// vdelta [ ... ] to add multiple vshaderparam's

//  defuniformparam "envscale" 0.2 0.2 0.2 // reflectivity
//  defuniformparam "envscale" 1 1 1 // reflectivity map multiplier
//
//  defuniformparam "glowcolor" 1 1 1 // glow color
//
//  defuniformparam "parallaxscale" 0.06 -0.03 // parallax scaling
//
//  defuniformparam "pulseglowcolor" 0 0 0 // pulse glow color
//
//  defuniformparam "pulseglowspeed" 1 // pulse frequency (Hz)
//
//  defuniformparam "pulsespeed" 1 // pulse frequency (Hz)     Is this one for the model shader?
//
//  defuniformparam "specscale" 1 1 1 // spec multiplier
//  defuniformparam "specscale" 6 6 6 // spec map multiplier


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Map Model Browser:

nodebug [
    defvarp mmguiwidth  2 7 12
    defvarp mmguiheight 2 4 12
    defvarp mmguiname   0 1  1

    defvar  MMB_ModelsPerTab 0 0 144
]

newgui "mapmodels" [
    if (|| (! $editing) (! (ingame))) [cleargui 1] [
        guikeeptab 1
        guinoautotab [
            MMB_ModelsPerTab = (* $mmguiwidth $mmguiheight)
            loop iTab (div (+ $nummapmodels (- $MMB_ModelsPerTab 1)) $MMB_ModelsPerTab) [
                if $iTab [guitab (+ $iTab 1)]
                if (= $guitabnum (+ $iTab 1)) [
                    loop iY $mmguiheight [
                        guilist [
                            loop iX $mmguiwidth [
                                iMdl = (+ (* $iTab $MMB_ModelsPerTab) (+ (* $iY $mmguiwidth) $iX))
                                guimodelpreview (mapmodelname $iMdl) "mapmodel" [newent mapmodel @iMdl] 3 1 $iMdl 1
                            ]
                        ]
                    ]
                    if (!= $mmguiname 0) [
                        guistrut 0.2
                        //guititle (concatword "^f7" (strreplace (strreplace $guirolloverpreviewname "\" "/") "/" "^f~/^f7"))
                        guititle (concatword "^f~[^f2" $iMdl "^f~] ^f2" $guirolloverpreviewname)
                    ]
                ]
            ]
        ]
    ]
]

//getmapmodels = [
//    loopconcat i $nummapmodels [
//        if $arg2 [ if (mapmodelloaded $i) [ $arg1 $i ] ] [ $arg1 $i ]
//    ]
//]

